---
description: インタラクティブまたは提供された原則入力からプロジェクト憲法を作成または更新し、すべての依存テンプレートが同期されるようにします
---

## ユーザー入力

```text
$ARGUMENTS
```

続行する前に、ユーザー入力を**必ず**考慮してください（空でない場合）。

## 概要

`.specify/memory/constitution.md` でプロジェクト憲法を更新しています。このファイルは、角括弧内のプレースホルダートークン（例: `[PROJECT_NAME]`、`[PRINCIPLE_1_NAME]`）を含むテンプレートです。あなたの仕事は、（a）具体的な値を収集/導出し、（b）テンプレートを正確に記入し、（c）依存アーティファクト全体に修正を伝播することです。

この実行フローに従ってください:

1. `.specify/memory/constitution.md` の既存の憲法テンプレートを読み込みます。
   - `[ALL_CAPS_IDENTIFIER]` 形式のすべてのプレースホルダートークンを特定します。
   **重要**: ユーザーはテンプレートで使用されているものよりも少ないまたは多い原則を必要とする場合があります。番号が指定されている場合、それを尊重してください - 一般的なテンプレートに従ってください。それに応じてドキュメントを更新します。

2. プレースホルダーの値を収集/導出:
   - ユーザー入力（会話）が値を提供する場合、それを使用します。
   - それ以外の場合、既存のリポジトリコンテキストから推論します（README、docs、埋め込まれている場合は以前の憲法バージョン）。
   - ガバナンス日付の場合: `RATIFICATION_DATE` は元の採用日です（不明な場合は尋ねるか TODO をマーク）、`LAST_AMENDED_DATE` は変更が行われた場合は今日、それ以外の場合は以前のものを保持します。
   - `CONSTITUTION_VERSION` はセマンティックバージョニングルールに従って増分する必要があります:
     - MAJOR: 後方互換性のないガバナンス/原則の削除または再定義。
     - MINOR: 新しい原則/セクションが追加または実質的に拡張されたガイダンス。
     - PATCH: 明確化、表現、タイポ修正、非セマンティックな改良。
   - バージョンバンプタイプが曖昧な場合、確定前に理由を提案します。

3. 更新された憲法コンテンツを起草:
   - すべてのプレースホルダーを具体的なテキストに置き換えます（意図的に保持されたテンプレートスロットを除いて、角括弧トークンは残りません—プロジェクトがまだ定義しないことを選択した場合—明示的に残されたものを正当化します）。
   - 見出し階層を保持し、コメントは置き換えられたら削除できますが、まだ明確化ガイダンスを追加する場合を除きます。
   - 各原則セクションを確保: 簡潔な名前行、交渉不可能なルールをキャプチャする段落（または箇条書きリスト）、明白でない場合は明示的な理由。
   - ガバナンスセクションが修正手順、バージョニングポリシー、コンプライアンスレビュー期待をリストすることを確保します。

4. 一貫性伝播チェックリスト（以前のチェックリストをアクティブな検証に変換）:
   - `.specify/templates/plan-template.md` を読み込み、"憲法チェック" またはルールが更新された原則と整合していることを確認します。
   - `.specify/templates/spec-template.md` をスコープ/要件の整合性について読み込み—憲法が必須セクションまたは制約を追加/削除する場合は更新します。
   - `.specify/templates/tasks-template.md` を読み込み、タスクの分類が新しいまたは削除された原則駆動のタスクタイプ（例: 可観測性、バージョニング、テスト規律）を反映していることを確認します。
   - `.specify/templates/commands/*.md` の各コマンドファイルを読み込み（これを含む）、汎用ガイダンスが必要な場合、古い参照（CLAUDE のようなエージェント固有の名前のみ）が残っていないことを確認します。
   - ランタイムガイダンスドキュメント（例: `README.md`、`docs/quickstart.md`、または存在する場合はエージェント固有のガイダンスファイル）を読み込みます。変更された原則への参照を更新します。

5. 同期影響レポートを作成（更新後に憲法ファイルの先頭に HTML コメントとして前置）:
   - バージョン変更: old → new
   - 変更された原則のリスト（名前が変更された場合、old title → new title）
   - 追加されたセクション
   - 削除されたセクション
   - 更新が必要なテンプレート（✅ 更新済み / ⚠ 保留中）とファイルパス
   - 意図的に延期されたプレースホルダーがある場合、フォローアップ TODO

6. 最終出力前の検証:
   - 説明されていない残りの角括弧トークンなし。
   - バージョン行がレポートと一致。
   - 日付 ISO フォーマット YYYY-MM-DD。
   - 原則は宣言的、テスト可能、曖昧な言語がない（"should" → 適切な場所で MUST/SHOULD 理由に置き換え）。

7. 完成した憲法を `.specify/memory/constitution.md` に書き戻します（上書き）。

8. ユーザーに最終サマリーを出力:
   - 新しいバージョンとバンプの理由。
   - 手動フォローアップのためにフラグが立てられたファイル。
   - 提案されたコミットメッセージ（例: `docs: amend constitution to vX.Y.Z (principle additions + governance update)`）。

フォーマットとスタイルの要件:

- テンプレートと完全に同じマークダウン見出しを使用します（レベルを降格/昇格しないでください）。
- 読みやすさを保つために長い理由の行をラップします（理想的には<100文字）が、ぎこちない改行でハードエンフォースしないでください。
- セクション間に1行の空白行を保ちます。
- 末尾の空白を避けます。

ユーザーが部分的な更新を提供する場合（例: 1つの原則の改訂のみ）、依然として検証とバージョン決定ステップを実行します。

重要な情報が欠落している場合（例: 批准日が本当に不明）、`TODO(<FIELD_NAME>): explanation` を挿入し、延期された項目の下の同期影響レポートに含めます。

新しいテンプレートを作成しないでください; 常に既存の `.specify/memory/constitution.md` ファイルで操作します。
