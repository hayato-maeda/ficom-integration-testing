---
description: 計画テンプレートを使用して実装計画ワークフローを実行し、デザインアーティファクトを生成します。
---

## ユーザー入力

```text
$ARGUMENTS
```

続行する前に、ユーザー入力を**必ず**考慮してください（空でない場合）。

## 概要

1. **セットアップ**: リポジトリルートから `.specify/scripts/bash/setup-plan.sh --json` を実行し、FEATURE_SPEC、IMPL_PLAN、SPECS_DIR、BRANCH の JSON を解析します。"I'm Groot" のような引数の一重引用符には、エスケープ構文を使用: 例 'I'\''m Groot'（または可能であれば二重引用符: "I'm Groot"）。

2. **コンテキストを読み込む**: FEATURE_SPEC と `.specify/memory/constitution.md` を読み込みます。IMPL_PLAN テンプレートを読み込みます（既にコピー済み）。

3. **計画ワークフローを実行**: IMPL_PLAN テンプレートの構造に従って:
   - 技術コンテキストを記入（不明な点は "要明確化" とマーク）
   - 憲法から憲法チェックセクションを記入
   - ゲートを評価（違反が正当化されていない場合はエラー）
   - Phase 0: research.md を生成（すべての要明確化を解決）
   - Phase 1: data-model.md、contracts/、quickstart.md を生成
   - Phase 1: エージェントスクリプトを実行してエージェントコンテキストを更新
   - 設計後に憲法チェックを再評価

4. **停止して報告**: コマンドは Phase 2 の計画後に終了します。ブランチ、IMPL_PLAN パス、および生成されたアーティファクトを報告します。

## フェーズ

### Phase 0: アウトライン & リサーチ

1. **上記の技術コンテキストから不明点を抽出**:
   - 各要明確化 → リサーチタスク
   - 各依存関係 → ベストプラクティスタスク
   - 各統合 → パターンタスク

2. **リサーチエージェントを生成してディスパッチ**:

   ```text
   技術コンテキストの各不明点について:
     タスク: "{機能コンテキスト} の {不明点} をリサーチ"
   各技術選択について:
     タスク: "{ドメイン} における {技術} のベストプラクティスを検索"
   ```

3. **調査結果を統合** し、`research.md` に次の形式で記録:
   - 決定: [何が選択されたか]
   - 根拠: [なぜ選択されたか]
   - 検討した代替案: [他に何が評価されたか]

**出力**: すべての要明確化が解決された research.md

### Phase 1: 設計 & コントラクト

**前提条件:** `research.md` が完了

1. **機能仕様からエンティティを抽出** → `data-model.md`:
   - エンティティ名、フィールド、関係
   - 要件からの検証ルール
   - 該当する場合は状態遷移

2. **機能要件から API コントラクトを生成**:
   - 各ユーザーアクション → エンドポイント
   - 標準的な REST/GraphQL パターンを使用
   - OpenAPI/GraphQL スキーマを `/contracts/` に出力

3. **エージェントコンテキストの更新**:
   - `.specify/scripts/bash/update-agent-context.sh claude` を実行
   - これらのスクリプトは使用中の AI エージェントを検出
   - 適切なエージェント固有のコンテキストファイルを更新
   - 現在の計画から新しい技術のみを追加
   - マーカー間の手動追加を保持

**出力**: data-model.md、/contracts/*、quickstart.md、エージェント固有のファイル

## 重要なルール

- 絶対パスを使用
- ゲート失敗または未解決の明確化についてエラー
